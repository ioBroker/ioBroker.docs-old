<!DOCTYPE html>
<!--[if IE 8 ]>
	<html class="no-js ie8" lang="de-DE">
<![endif]-->
<!--[if IE 9 ]>
	<html class="no-js ie9" lang="de-DE">
<![endif]-->
<!--[if gt IE 9]><!-->
<html lang="de-DE"><!--<![endif]-->
	<head>
				<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE"> 

		<link rel="profile" href="http://gmpg.org/xfn/11">
		<link rel="pingback" href="http://www.iobroker.net/docu/xmlrpc.php">
		
		<title>Stromverbrauch erfassen &#8211; ioBroker</title>
<link rel='dns-prefetch' href='//netdna.bootstrapcdn.com'>
<link rel='dns-prefetch' href='//s.w.org'>
<link rel="alternate" type="application/rss+xml" title="ioBroker &raquo; Feed" href="index.rss?feed=rss2&#038;lang=de">
<link rel="alternate" type="application/rss+xml" title="ioBroker &raquo; Kommentar-Feed" href="index-1.rss?feed=comments-rss2&#038;lang=de">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.iobroker.net\/docu\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.5"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css' href='wp-content\plugins\crayon-syntax-highlighter\css\min\crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all'>
<link rel='stylesheet' id='crayon-theme-classic-css' href='wp-content\plugins\crayon-syntax-highlighter\themes\classic\classic.css?ver=_2.7.2_beta' type='text/css' media='all'>
<link rel='stylesheet' id='crayon-font-monaco-css' href='wp-content\plugins\crayon-syntax-highlighter\fonts\monaco.css?ver=_2.7.2_beta' type='text/css' media='all'>
<link rel='stylesheet' id='contact-form-7-css' href='wp-content\plugins\contact-form-7\includes\css\styles.css?ver=4.9.2' type='text/css' media='all'>
<link rel='stylesheet' id='cookie-law-info-css' href='wp-content\plugins\cookie-law-info\public\css\cookie-law-info-public.css?ver=1.7.6' type='text/css' media='all'>
<link rel='stylesheet' id='cookie-law-info-gdpr-css' href='wp-content\plugins\cookie-law-info\public\css\cookie-law-info-gdpr.css?ver=1.7.6' type='text/css' media='all'>
<link rel='stylesheet' id='dedo-css-css' href='wp-content\plugins\delightful-downloads\assets\css\delightful-downloads.min.css?ver=1.6.6' type='text/css' media='all'>
<link rel='stylesheet' id='mbpro-font-awesome-css' href='wp-content\plugins\maxbuttons\assets\libraries\font-awesome\css\font-awesome.min.css?ver=6.28' type='text/css' media='all'>
<link rel='stylesheet' id='page-list-style-css' href='wp-content\plugins\page-list\css\page-list.css?ver=5.1' type='text/css' media='all'>
<link rel='stylesheet' id='pc_google_analytics-frontend-css' href='http://www.iobroker.net/docu/wp-content/plugins/pc-google-analytics/assets/css/frontend.css?ver=1.0.0' type='text/css' media='all'>
<link rel='stylesheet' id='font-awesome-css' href='//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css' type='text/css' media='screen'>
<link rel='stylesheet' id='toc-screen-css' href='wp-content\plugins\table-of-contents-plus\screen.min.css?ver=1509' type='text/css' media='all'>
<link rel='stylesheet' id='parent-style-css' href='wp-content\themes\responsive-mobile\style.css?ver=4.7.5' type='text/css' media='all'>
<link rel='stylesheet' id='responsive-mobile-style-css' href='wp-content\themes\responsive-mobile\css\style.css?ver=1.8' type='text/css' media='all'>
<link rel='stylesheet' id='responsive-mobile-child-style-css' href='wp-content\themes\responsive-mobile_child\style.css?ver=1.0' type='text/css' media='all'>
<link rel='stylesheet' id='recent-posts-widget-with-thumbnails-public-style-css' href='wp-content\plugins\recent-posts-widget-with-thumbnails\public.css?ver=6.5.0' type='text/css' media='all'>
<link rel='stylesheet' id='cleverness_todo_list_frontend-css' href='wp-content\plugins\cleverness-to-do-list\css\cleverness-to-do-list-frontend.css?ver=3.4.2' type='text/css' media='all'>
<link rel='stylesheet' id='jquery.ui.theme-css' href='wp-content\plugins\cleverness-to-do-list\css\jquery-ui-fresh.css?ver=3.4.2' type='text/css' media='all'>
<link rel='stylesheet' id='tablepress-default-css' href='wp-content\tablepress-combined.min.css?ver=128' type='text/css' media='all'>
<link rel='stylesheet' id='bootstrap-css' href='wp-content\themes\responsive-mobile\libraries\bootstrap\css\bootstrap.min.css?ver=4.7.5' type='text/css' media='all'>
<script type='text/javascript' src='wp-includes\js\jquery\jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='wp-includes\js\jquery\jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.iobroker.net\/docu\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Dr\u00fccken Sie %s zum Kopieren, %s zum Einf\u00fcgen","minimize":"Klicken um Code aufzuklappen"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content\plugins\crayon-syntax-highlighter\js\min\crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var Cli_Data = {"nn_cookie_ids":[],"cookielist":[]};
var log_object = {"ajax_url":"http:\/\/www.iobroker.net\/docu\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content\plugins\cookie-law-info\public\js\cookie-law-info-public.js?ver=1.7.6'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var mb_ajax = {"ajaxurl":"http:\/\/www.iobroker.net\/docu\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content\plugins\maxbuttons\js\min\front.js?ver=6.28'></script>
<script type='text/javascript' src='wp-content\plugins\pc-google-analytics\assets\js\frontend.min.js?ver=1.0.0'></script>
<script type='text/javascript' src='wp-content\themes\responsive-mobile\libraries\bootstrap\js\bootstrap.min.js?ver=4.7.5'></script>
<link rel='https://api.w.org/' href='index.json?rest_route=/'>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.xml?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes\wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.7.5">
<link rel="canonical" href="index-307.htm?page_id=3640&#038;lang=de">
<link rel='shortlink' href='http://www.iobroker.net/docu/?p=3640'>
<link rel="alternate" type="application/json+oembed" href="index-283.json?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=http%3A%2F%2Fwww.iobroker.net%2Fdocu%2F%3Fpage_id%3D3640%26lang%3Dde">
<link rel="alternate" type="text/xml+oembed" href="index-282.xml?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=http%3A%2F%2Fwww.iobroker.net%2Fdocu%2F%3Fpage_id%3D3640%26lang%3Dde&#038;format=xml">
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		ga('create', 'UA-86900958-1', 'auto');
		ga('send', 'pageview');
		
		</script>

<style>
.scroll-back-to-top-wrapper {
    position: fixed;
	opacity: 0;
	visibility: hidden;
	overflow: hidden;
	text-align: center;
	z-index: 99999999;
    background-color: #777777;
	color: #eeeeee;
	width: 50px;
	height: 48px;
	line-height: 48px;
	right: 30px;
	bottom: 30px;
	padding-top: 2px;
	border-top-left-radius: 10px;
	border-top-right-radius: 10px;
	border-bottom-right-radius: 10px;
	border-bottom-left-radius: 10px;
	-webkit-transition: all 0.5s ease-in-out;
	-moz-transition: all 0.5s ease-in-out;
	-ms-transition: all 0.5s ease-in-out;
	-o-transition: all 0.5s ease-in-out;
	transition: all 0.5s ease-in-out;
}
.scroll-back-to-top-wrapper:hover {
	background-color: #888888;
  color: #eeeeee;
}
.scroll-back-to-top-wrapper.show {
    visibility:visible;
    cursor:pointer;
	opacity: 1.0;
}
.scroll-back-to-top-wrapper i.fa {
	line-height: inherit;
}
.scroll-back-to-top-wrapper .fa-lg {
	vertical-align: 0;
}
</style><!-- Analytics by WP-Statistics v12.6 - https://wp-statistics.com/ -->
		<script type="text/javascript">
			var cli_flush_cache=1;
		</script>
				<style type="text/css" id="wp-custom-css">
			/*
You can add your own CSS here.

Click the help icon above to learn more.
*/
.site-content .content-area{
	/*background: #6592c9;*/
}		</style>
	<style type="text/css">
.paypal-donations { text-align: center !important }
</style>
	</head>

<body class="page-template-default page page-id-3640 page-child parent-pageid-3526 group-blog default" itemscope="itemscope" itemtype="http://schema.org/WebPage">
<div id="container" class="site">
	<a class="skip-link screen-reader-text" href="#content">Springe zum Inhalt</a>
	<a class="skip-link screen-reader-text" href="#main-navigation">Zum Hauptmenü springen</a>
	<div id="top-menu-container" class="container-full-width">
		<nav id="top-menu" class="container" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
			<ul id="menu-2016_top_menue" class="top-menu"><li id="menu-item-2203-de" class="lang-item lang-item-4 lang-item-de lang-item-first current-lang menu-item menu-item-type-custom menu-item-object-custom menu-item-2203-de"><a href="index-307.htm?page_id=3640&#038;lang=de" hreflang="de-DE" lang="de-DE">Deutsch</a></li>
<li id="menu-item-2203-en" class="lang-item lang-item-7 lang-item-en no-translation menu-item menu-item-type-custom menu-item-object-custom menu-item-2203-en"><a href="index-1.htm?lang=en" hreflang="en-GB" lang="en-GB">English</a></li>
<li id="menu-item-2203-ru" class="lang-item lang-item-20 lang-item-ru no-translation menu-item menu-item-type-custom menu-item-object-custom menu-item-2203-ru"><a href="index-2.htm?lang=ru" hreflang="ru-RU" lang="ru-RU">Русский</a></li>
</ul>		</nav>
	</div><!-- top menu container -->
        <div id="header_section">
	<header id="header" class="container-full-width site-header" role="banner" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
				<div class="container">
			<div class="header-row">
				<div id="site-branding">
							<div id="logo">
			<a href="index.htm?lang=de" rel="home" itemprop="url" title="ioBroker">
				<img src="wp-content\uploads\ioBroker_logo_lang-e1456684383484.png" alt="ioBroker" itemprop="image">
			</a>
		</div>
					</div>
				<div id="secondary-header">
					
	<div id="top-widget" class="top-widget" role="complementary" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
		
			<div id="search-2" class="responsive-mobile-top-widget widget_search"><form role="search" method="get" class="search-form" action="http://www.iobroker.net/docu/">
				<label>
					<span class="screen-reader-text">Suche nach:</span>
					<input type="search" class="search-field" placeholder="Suche&#160;&hellip;" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Suche">
			<input type="hidden" name="lang" value="de"></form></div>
			</div><!-- end of #top-widget -->
				</div>
			</div>
		</div>

			</header><!-- #header -->

	<div id="main-menu-container" class="container-full-width">
		<div id="main-menu" class="container">
			<nav id="main-navigation" class="site-navigation" role="navigation" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
				<div id="mobile-current-item">Menü</div>
				<button id="mobile-nav-button"><span class="accessibile-label">Mobile-Menü ein-/ausschalten</span></button>
				<div class="main-nav"><ul id="menu-2016_kopfzeile_de" class="menu"><li id="menu-item-2204" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2204"><a href="..\index.htm">Startseite</a></li>
<li id="menu-item-7199" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7199"><a href="http://www.iobrokers.de/">Shop</a></li>
<li id="menu-item-2278" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2278"><a href="index-3.htm?page_id=2258&#038;lang=de">Aktuelles</a></li>
<li id="menu-item-2626" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2626"><a href="index-4.htm?page_id=2375&#038;lang=de">Einleitung</a>
<ul class="sub-menu">
	<li id="menu-item-6381" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6381"><a href="index-4.htm?page_id=2375&#038;lang=de">für alle</a></li>
	<li id="menu-item-6380" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-6380"><a href="index-5.htm?page_id=6317&#038;lang=de">für Einsteiger</a>
	<ul class="sub-menu">
		<li id="menu-item-6451" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6451"><a href="index-6.htm?page_id=6335&#038;lang=de">Server aufsetzen</a></li>
		<li id="menu-item-6450" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6450"><a href="index-7.htm?page_id=5063&#038;lang=de">erste Adapter</a></li>
		<li id="menu-item-6449" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6449"><a href="index-8.htm?page_id=6365&#038;lang=de">erste Visualisierung</a></li>
		<li id="menu-item-6826" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6826"><a href="index-9.htm?page_id=6548&#038;lang=de">Daten loggen</a></li>
		<li id="menu-item-6825" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6825"><a href="index-10.htm?page_id=6562&#038;lang=de">erster Chart</a></li>
	</ul>
</li>
	<li id="menu-item-2289" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2289"><a href="index-11.htm?page_id=2281&#038;lang=de">für Entwickler</a></li>
</ul>
</li>
<li id="menu-item-2290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2290"><a href="index-12.htm?page_id=2279&#038;lang=de">Installation / Start</a>
<ul class="sub-menu">
	<li id="menu-item-2395" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2395"><a href="index-13.htm?page_id=2387&#038;lang=de">Videos</a></li>
	<li id="menu-item-3336" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3336"><a href="index-14.htm?page_id=3334&#038;lang=de">Plattformen / Betriebssystem</a>
	<ul class="sub-menu">
		<li id="menu-item-8383" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8383"><a href="index-15.htm?page_id=8323&#038;lang=de">Linux Schnellstart (auch für Raspberry Pi 2/3)</a></li>
		<li id="menu-item-8382" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8382"><a href="index-16.htm?page_id=8327&#038;lang=de">Schnellstart für Raspberry Pi 1</a></li>
		<li id="menu-item-8429" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8429"><a href="index-17.htm?page_id=8390&#038;lang=de">Windows</a></li>
		<li id="menu-item-2300" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2300"><a href="index-18.htm?page_id=2293&#038;lang=de">OS X</a></li>
		<li id="menu-item-3337" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3337"><a href="index-19.htm?page_id=2563&#038;lang=de">Downloads für die Installation</a></li>
		<li id="menu-item-5362" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5362"><a href="index-20.htm?page_id=5358&#038;lang=de">Einrichtung und Installation von ioBroker in VirtualBox</a></li>
		<li id="menu-item-6767" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6767"><a href="index-21.htm?page_id=6764&#038;lang=de">ioBroker mit Cloud auf QNAP-453a</a></li>
	</ul>
</li>
	<li id="menu-item-2358" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2358"><a href="index-22.htm?page_id=2354&#038;lang=de">Erster Start von ioBroker</a></li>
	<li id="menu-item-8530" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8530"><a href="index-23.htm?page_id=8511&#038;lang=de">Grundlagen zur Verwendung von Adaptern</a></li>
	<li id="menu-item-3070" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3070"><a href="index-24.htm?page_id=3068&#038;lang=de">Multihost Modus</a></li>
	<li id="menu-item-5890" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5890"><a href="index-25.htm?page_id=5859&#038;lang=de">Alexa mit ioBroker (Schnellstart)</a></li>
	<li id="menu-item-3964" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3964"><a href="index-26.htm?page_id=3928&#038;lang=de">ioBroker läuft nicht mehr</a></li>
	<li id="menu-item-5532" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5532"><a href="index-27.htm?page_id=5510&#038;lang=de">Wie das Packet serialport oder ähnlich zu installieren</a></li>
</ul>
</li>
<li id="menu-item-2248" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2248"><a href="index-28.htm?page_id=2236&#038;lang=de">Adapter</a>
<ul class="sub-menu">
	<li id="menu-item-2249" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2249"><a href="index-29.htm?page_id=2238&#038;lang=de">Allgemein</a></li>
	<li id="menu-item-2429" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2429"><a href="index-30.htm?page_id=2407&#038;lang=de">Aufbewahrung</a>
	<ul class="sub-menu">
		<li id="menu-item-6988" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6988"><a href="index-31.htm?page_id=5197&#038;lang=de">Howto – MariaDB auf der Synology DiskStation als Datenbank für Flot</a></li>
	</ul>
</li>
	<li id="menu-item-2430" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2430"><a href="index-32.htm?page_id=2405&#038;lang=de">Hardware</a></li>
	<li id="menu-item-2425" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2425"><a href="index-33.htm?page_id=2417&#038;lang=de">Kommunikation</a></li>
	<li id="menu-item-2424" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2424"><a href="index-34.htm?page_id=2419&#038;lang=de">Medien</a></li>
	<li id="menu-item-2426" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2426"><a href="index-35.htm?page_id=2415&#038;lang=de">Skripte und Logik</a></li>
	<li id="menu-item-2427" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2427"><a href="index-36.htm?page_id=2412&#038;lang=de">ioBroker.vis</a>
	<ul class="sub-menu">
		<li id="menu-item-5035" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5035"><a href="index-37.htm?page_id=5026&#038;lang=de">ioBroker.vis App</a></li>
	</ul>
</li>
	<li id="menu-item-2431" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2431"><a href="index-38.htm?page_id=2403&#038;lang=de">Visualisierung</a></li>
	<li id="menu-item-2423" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2423"><a href="index-39.htm?page_id=2421&#038;lang=de">Wartung</a></li>
	<li id="menu-item-2432" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2432"><a href="index-40.htm?page_id=2401&#038;lang=de">Wetter</a></li>
	<li id="menu-item-2428" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2428"><a href="index-41.htm?page_id=2410&#038;lang=de">Zeitplanung</a></li>
</ul>
</li>
<li id="menu-item-2805" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-has-children menu-item-2805"><a href="index-42.htm?page_id=2786&#038;lang=de">Scripte</a>
<ul class="sub-menu">
	<li id="menu-item-5401" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5401"><a href="index-43.htm?page_id=5385&#038;lang=de">Einführung Programmieren mit Javascript</a></li>
	<li id="menu-item-3757" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-3757"><a href="index-44.htm?page_id=3526&#038;lang=de">Counter</a></li>
	<li id="menu-item-3758" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3758"><a href="index-45.htm?page_id=3585&#038;lang=de">Heizung / Lüftung</a></li>
	<li id="menu-item-3759" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3759"><a href="index-46.htm?page_id=3587&#038;lang=de">Info / Status</a></li>
	<li id="menu-item-3755" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3755"><a href="index-47.htm?page_id=3589&#038;lang=de">Mediensteuerung</a></li>
	<li id="menu-item-3754" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3754"><a href="index-48.htm?page_id=3593&#038;lang=de">Steuern / Regeln</a></li>
	<li id="menu-item-3756" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3756"><a href="index-49.htm?page_id=3591&#038;lang=de">Zeitsteuerung</a></li>
</ul>
</li>
<li id="menu-item-2288" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2288"><a href="index-50.htm?page_id=2283&#038;lang=de">Downloads</a>
<ul class="sub-menu">
	<li id="menu-item-2806" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2806"><a href="index-19.htm?page_id=2563&#038;lang=de">Downloads für die Installation</a></li>
	<li id="menu-item-5146" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-5146"><a href="index-42.htm?page_id=2786&#038;lang=de">Scripte</a></li>
</ul>
</li>
<li id="menu-item-2287" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2287"><a href="index-51.htm?page_id=2285&#038;lang=de">Forum / Support</a>
<ul class="sub-menu">
	<li id="menu-item-2379" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2379"><a href="http://forum.iobroker.net">Forum</a></li>
	<li id="menu-item-7324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7324"><a href="index-52.htm?page_id=7322&#038;lang=de">Glossar</a></li>
	<li id="menu-item-2396" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2396"><a href="index-53.htm?page_id=2380&#038;lang=de">FAQ</a></li>
	<li id="menu-item-8440" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8440"><a href="index-54.htm?page_id=8438&#038;lang=de">Troubleshooting (in Arbeit)</a></li>
	<li id="menu-item-2394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2394"><a href="index-55.htm?page_id=2392&#038;lang=de">Tipps und Tricks</a></li>
</ul>
</li>
</ul></div>			</nav><!-- #site-navigation -->
		</div><!-- #main-menu -->
	</div><!-- #main-menu-container -->
	<div id="sub-menu-container" class="container-full-width">
		<div id="sub-menu" class="container">
			<nav id="sub-navigation" class="site-navigation" role="navigation" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
						</nav><!-- #site-navigation -->
		</div><!-- #sub-menu -->
	</div><!-- #sub-menu-container -->
        </div>
	<div id="wrapper" class="site-content container-full-width">

	<div id="content" class="content-area">
			<main id="main" class="site-main" role="main">

				<div class="breadcrumb-list" xmlns:v="http://rdf.data-vocabulary.org/#"><span class="breadcrumb" typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="index.htm?lang=de">Home</a></span> <span class="chevron">&#8250;</span> <span class="breadcrumb" typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="index-163.htm?page_id=2364&lang=de">Deutsch</a></span> <span class="chevron">&#8250;</span> <span class="breadcrumb" typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="index-42.htm?page_id=2786&lang=de">Scripte</a></span> <span class="chevron">&#8250;</span> <span class="breadcrumb" typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="index-44.htm?page_id=3526&lang=de">Counter</a></span> <span class="chevron">&#8250;</span> <span class="breadcrumb-current">Stromverbrauch erfassen</span></div>
				
					
<article id="post-3640" class="post-3640 page type-page status-publish hentry">
		
	
<header class="entry-header">
	
	</header><!-- .entry-header -->

	<div class="post-entry">
		<h1><span id="Stromverbrauch_erfassen">Stromverbrauch erfassen</span></h1>
<p>Erfassen des Stromverbrauchs pro Zeitraum. Es können mehrere Geräte geloggt werden. Perioden sind: Tag, Woche, Monat, Quartal und Jahr</p>
<div id="toc_container" class="no_bullets"><ul class="toc_list"><li><a href="#Stromverbrauch_erfassen"><span class="toc_number toc_depth_1">1</span> Stromverbrauch erfassen</a><ul><li><a href="#Steckbrief"><span class="toc_number toc_depth_2">1.1</span> Steckbrief</a></li><li><a href="#Script"><span class="toc_number toc_depth_2">1.2</span> Script</a></li></ul></li></ul></div>

<table width="100%">
<tbody>
<tr>
<td style="width: 50%;">
<h2><span id="Steckbrief">Steckbrief</span></h2>
</td>
<td style="width: 50%;"></td>
</tr>
<tr>
<td style="width: 50%;"><strong>Art des Scripts</strong></td>
<td style="width: 50%;">Komplettscript</td>
</tr>
<tr>
<td style="width: 50%;"><strong>Aktuelle Version</strong></td>
<td style="width: 50%;"></td>
</tr>
<tr>
<td style="width: 50%;"><strong>Voraussetzungen</strong></td>
<td style="width: 50%;">Homematic Zentrale</td>
</tr>
<tr>
<td style="width: 50%;"><strong>Entwickler</strong></td>
<td style="width: 50%;">pix</td>
</tr>
<tr>
<td style="width: 50%;"><strong>Stichworte</strong></td>
<td style="width: 50%;">Stromverbrauch</td>
</tr>
<tr>
<td style="width: 50%;"><strong>Zusatzinformation</strong></td>
<td style="width: 50%;"></td>
</tr>
<tr>
<td style="width: 50%;"><strong>Forendiskussion</strong></td>
<td style="width: 50%;"><a href="http://forum.iobroker.net/viewtopic.php?f=21&t=2262&sid=11762639a96c9f3e7ae0be4c269bc4bf">zum Forum</a></td>
</tr>
</tbody>
</table>
<h2><span id="Script">Script</span></h2>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cefa6c47352c166909499" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Zeilennummern"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Unformatierte Code-Ansicht"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Zeilenumbruch umschalten"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Code aufklappen"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Code in einem neuen Fenster anzeigen"><div class="crayon-button-icon"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/* Strom Zaehlerstaende, Verbrauch und Kosten

Skript dient zur Ermittlung des Stromverbrauchs bei Geräten, 
die mit den Homematic Zwischenstecker-Schaltaktor mit Leistungsmessung oder den FS20 EM1000 verbunden sind

Zählerstände werden gespeichert jeweils
-jeden Tag
-jede Woche Montag
-jeden Monatsersten
-jeden Quartalsersten
-jedes Neujahr
wenn ein neuer Wert reinkommt.

Der Strompreis wird in die Variable "Strompreis_aktuell" geschrieben. 
Änderungen des Strompreispreises müssen rechtzeitig per Cronjob programmiert werden.

Die Stromkosten (Verbrauch * Preis) werden ebenso
-jeden Tag
-jede Woche Montag
-jeden Monatsersten
-jeden Quartalsersten
-jedes Neujahr

genullt und bis dahin durch die Berechnung (der Differenz des aktuellen Zählerstandes - Zählerstand Beginn des Zeitraums) * Strompreis ermittelt

Der kumulierte Zählerstand berücksichtigt evtl. Resets und Überläufe der realen Zählerstände der Geräte.

Todo: Wenn aktueller Zählerstand &lt; letzter Zählerstand, dann push und korrektur 
wie hier: http://homematic-forum.de/forum/viewtopic.php?f=27&amp;t=23688&amp;p=201954&amp;hilit=HM+ES+PMSw1+Pl+Zähler#p201959

erstellt: 09.02.2016 von pix auf Basis des alten Skriptes
01.03.2016 Leerzeichen werden aus Gerätenamen gelöscht
*/

var logging = false;
var instanz = 'javascript.2';  instanz = instanz + '.';
var pfad =     'Strom.';                                                   // Pfad innerhalb der Instanz
var blacklist= [' Strommessung', ' Küche'];                                     // persönliche Blacklist: Diese Teile werden aus den Homematic Gerätenamen entfernt

// Variablen erstellen, Zählerstände einlesen und Stromkosten errechnen (pro Gerät)
// Strompreis
createState(pfad + 'Preis.aktuell.Arbeitspreis', 0.2495, {
    name: 'Strompreis - aktueller Arbeitspreis (brutto)',
    unit: '€/kWh'
});
createState(pfad + 'Preis.aktuell.Grundpreis', 3.95, {                           // wird noch nicht eingerechnet
    name: 'Strompreis - aktueller Grundpreis (brutto)',
    unit: '€/Monat'
});

var idStrompreis = instanz + pfad + 'Preis.aktuell.Arbeitspreis';

// Einlesen der aktuellen Daten vom Zähler
on({id: /\.METER|\.ENERGY_COUNTER$/
}, function(obj) {
    
    var idbyname = getIdByName(obj.common.name, true);
    if (logging) {   
        log('-------- Strommesser ---------');
        log('RegExp-Funktion ausgelöst');
        log('Gewerk:       ' + obj.role);   // undefined
        log('Beschreibung: ' + obj.desc);   // undefined
        log('id:           ' + obj.id);
        log('Name:         ' + obj.common.name);   // Waschmaschine Küche:2.ENERGY_COUNTER !!!!! Mac mini Strommessung.METER
        log('channel ID:   ' + obj.channelId);     // hm-rpc.0.MEQ0170864.2
        log('channel Name: ' + obj.channelName);   // Waschmaschine Küche:2
        log('device ID:    ' + obj.deviceId);      // hm-rpc.0.MEQ0170864
        log('device name:  ' + obj.deviceName);    // Küche Waschmaschine
        log('neuer Wert:   ' + obj.newState.val);  // 16499.699982
        log('alter Wert:   ' + obj.oldState.val);  // 16499.699982
        log('Einheit:      ' + obj.common.unit);   // Wh
        log('IDbyNameFunktion: ' + idbyname[0]); // hm-rpc.0.MEQ0170864.2.ENERGY_COUNTER
    }
    // Gerätenamen erstellen
    var geraetename = entferneDatenpunkt(obj.common.name);
    geraetename = geraetename.replace(/\s/g, ""); // per Regexp Leerzeichen entfernen
    if (logging) log('Gerätename: ' + geraetename); 
    
    // States erstellen (CreateStates für dieses Gerät)
    erstelleStates (geraetename);
    
    // prüfe eingehende Daten
      // nicht nötig, da subscribe eh nur anspringt, wenn gelieferte Daten = oder &gt; sind als alte (gt)
      // zweiter subscribe übernimmt das
      
    // prüfe und schreibe Daten  
    var idKumuliert =  instanz + pfad + geraetename + '.Zaehlerstand.kumuliert',
        idBackup =     instanz + pfad + geraetename + '.Zaehlerstand.Backup';
    
    if (obj.newState.val &gt;= obj.oldState.val) {                                     // neuer Wert größer alter wert -&gt; alles gut
        setState(idKumuliert, obj.newState.val + getState(idBackup).val);           // Kumulierten Wert mit Ist-Wert (inkl. Backup) synchronisieren
    } else {                                                                        // neuer Wert kleiner als alter Wert -&gt; Achtung Zähler im Gerät übergelaufen oder genullt
        var differenz = obj.oldState.val - obj.newState.val;                        // Differenz berechnen
        setState(idBackup, getState(idBackup).val + differenz);                     // und Differenz und Backup addieren "und den Werteabriss ausgleichen"
        setState(idKumuliert, data.newState.val + getState(idBackup).val);          // damit neuer kumulierter Wert stetig weiter wächst
        meldung = 'Achtung!\n\n' 
                + 'Der Stromzählerstand (' + geraetename + ') ist übergelaufen oder gelöscht worden (ggf. Stromausfall).\n'
                + 'Der letzte Zählerstand vor dem Reset wird nun zum Neuen addiert. Bitte unbedingt die Werte prüfen. \n\n '
                + 'ioBroker';
        betreff = 'ioBroker Meldung';
        prio = getState(OptinPushPrio).val;
        meldung_push(meldung, betreff, prio);
        log('Zählerstand (' + geraetename + ') übergelaufen oder genullt. Backup wird ab jetzt verwendet.', 'error');
    }
    
    // aktualisiere den Verbrauch und die Kosten
    berechneVerbrauchKosten(geraetename, (getState(idKumuliert).val / 1000).toFixed(3), getState(idStrompreis).val); // in kWh
   
    // ETAPPENWERTE SPEICHERN und RESETS DER WERTE #################################
    // Verzögerungen eingebaut. Resets, wenn die ersten Werte der neuen Etappe reinkommen
    if ( zeit(obj.oldState.ts).Stunde &gt; zeit(obj.newState.ts).Stunde ) { // neue Stunde kleiner als alte Stunde (Mitternacht)
        setTimeout(function() {
            resetKostenVerbrauch(geraetename, 'Tag');
        }, 1000);
        setTimeout(function() {
            schreibeZaehlerstand(geraetename, 'Tag');
        }, 1500);
    }  
    if ( zeit(obj.oldState.ts).Wochentag ===  0 &amp;&amp; zeit(obj.newState.ts).Wochentag === 1) { // So auf Mo
        setTimeout(function() {
            resetKostenVerbrauch(geraetename, 'Woche');
        }, 2000);
        setTimeout(function() {
            schreibeZaehlerstand(geraetename, 'Woche');
        }, 2500);
    }   
    if ( zeit(obj.oldState.ts).Tag &gt; zeit(obj.newState.ts).Tag ) { // wenn alter Tag größer als neuer Tag (am 1. eines Monats)   
        setTimeout(function() {
            resetKostenVerbrauch(geraetename, 'Monat');
        }, 3000);
        setTimeout(function() {
            schreibeZaehlerstand(geraetename, 'Monat');
        }, 3500);
    }    
    var old_month = parseInt(zeit(obj.oldState.ts).Monat,10);
    var new_month = parseInt(zeit(obj.state.ts).Monat, 10);
    // wenn obj.oldState.ts im März [3] und obj.newState.ts im April [4] oder
    //      obj.oldState.ts im Juni [6] und obj.newState.ts im Juli [7] oder
    //      obj.oldState.ts im Sept [9] und obj.newState.ts im Okt [10] oder
    //      obj.oldState.ts im Dez [12] und obj.newState.ts im Jan [1], dann Quartal
    //log('Monat (alt): ' + old_month);
    //log('Monat (neu): ' + new_month);
    if ( (old_month === 3 &amp;&amp; new_month === 4)  || (old_month === 6 &amp;&amp; new_month === 7)  || (old_month === 9 &amp;&amp; new_month === 10)  || (old_month === 12 &amp;&amp; new_month === 1) ) {
        setTimeout(function() {
            resetKostenVerbrauch(geraetename, 'Quartal');
        }, 4000);
        setTimeout(function() {
            schreibeZaehlerstand(geraetename, 'Quartal');
        }, 4500);
    }
    // wenn obj.oldState.ts im alten Jahr liegt, dann Jahr
    if (zeit(obj.oldState.ts).Jahr &lt; zeit(jetzt).Jahr) {
        setTimeout(function() {
            resetKostenVerbrauch(geraetename, 'Jahr');
        }, 5000);
        setTimeout(function() {
            schreibeZaehlerstand(geraetename, 'Jahr');
        }, 5500);
    }
    if (logging) log('------------ ENDE ------------');
});

function schreibeZaehlerstand(geraet, zeitraum) { 
    var idKumuliert =    instanz + pfad + geraet + '.Zaehlerstand.kumuliert',
        idZaehlerstand = instanz + pfad + geraet + '.Zaehlerstand.' + zeitraum;
                                                                                  // Zählerstand für übergebene Zeitraum und das Gerät in Wh auslesen 
        setState(idZaehlerstand, parseFloat( (getState(idKumuliert).val / 1000).toFixed(3)) );  // und in kWh (mit drei Dezimalstellen) speichern (also durch 1000)
    
        // hier externe Protokollierung in Datei einbauen
        
        log('Zählerstände für das Gerät ' + geraet + ' (' + zeitraum + ') gespeichert');
} 

function resetKostenVerbrauch(geraet, zeitraum) { 
    setState(instanz + pfad + geraet + '.Kosten.' + zeitraum, 0);        // Reset der Stromkosten für den übergebenen Zeitraum
    setState(instanz + pfad + geraet + '.Verbrauch.' + zeitraum, 0);     // Reset des Stromverbrauchs für den übergebenen Zeitraum 
    log('Stromkosten und Stromverbrauch für das Gerät ' + geraet + ' (' + zeitraum + ') zurückgesetzt');
} 

function zeit (time) {
    jetzt = new Date(formatDate(time,"JJJJ.MM.TT SS:mm:ss"));
    var jahr       = jetzt.getFullYear();
    var monat      = (jetzt.getMonth()+1 &lt; 10) ? '0' + (jetzt.getMonth()+1) : jetzt.getMonth()+1;
    var tag        = (jetzt.getDate() &lt; 10) ? '0' + jetzt.getDate() : jetzt.getDate();
    var wochentag  = jetzt.getDay(); // startet am Sonntag mit 0
    var stunde     = (jetzt.getHours() &lt; 10) ? '0' + jetzt.getHours() : jetzt.getHours();
    var minute     = (jetzt.getMinutes() &lt; 10) ? '0' + jetzt.getMinutes() : jetzt.getMinutes();
    var sekunde    = (jetzt.getSeconds() &lt; 10) ? '0' + jetzt.getSeconds() : jetzt.getSeconds();
    return {
        'Jahr'      : jahr,
        'Monat'     : monat,
        'Tag'       : tag,
        'Wochentag' : wochentag,
        'Stunde'    : stunde,
        'Minute'    : minute,
        'Sekunde'   : sekunde
    };
}

function berechneVerbrauchKosten(geraet, zaehler, preis) {                      // bei jedem eingehenden Wert pro Gerät
    // Tag [Verbrauchskosten = (Zähler_ist - Zähler_Tagesbeginn) * Preis ] --- zaehler muss immer größer sein als Tages, Wochen, etc.-Wert
    setState(instanz + pfad + geraet + '.Verbrauch.Tag',     (zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Tag').val).toFixed(3));           // Verbrauch an diesem Tag in kWh
    setState(instanz + pfad + geraet + '.Kosten.Tag',       ((zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Tag').val) * preis).toFixed(3));  // Kosten an diesem Tag in €
    // Woche    
    setState(instanz + pfad + geraet + '.Verbrauch.Woche',   (zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Woche').val).toFixed(3));
    setState(instanz + pfad + geraet + '.Kosten.Woche',     ((zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Woche').val) * preis).toFixed(3));
    // Monat    
    setState(instanz + pfad + geraet + '.Verbrauch.Monat',   (zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Monat').val).toFixed(3));
    setState(instanz + pfad + geraet + '.Kosten.Monat',     ((zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Monat').val) * preis).toFixed(3));
    // Quartal    
    setState(instanz + pfad + geraet + '.Verbrauch.Quartal', (zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Quartal').val).toFixed(3));
    setState(instanz + pfad + geraet + '.Kosten.Quartal',   ((zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Quartal').val) * preis).toFixed(3));
    // Jahr    
    setState(instanz + pfad + geraet + '.Verbrauch.Jahr',    (zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Jahr').val).toFixed(3));
    setState(instanz + pfad + geraet + '.Kosten.Jahr',      ((zaehler - getState(instanz + pfad + geraet + '.Zaehlerstand.Jahr').val) * preis).toFixed(3));  
    if (logging) log('Stromverbrauch und -kosten (' + geraet + ') aktualisiert', 'info');
}

function erstelleStates (geraet) {
    // Kumulierter Zählerstand (wird nie kleiner)
    createState(pfad + geraet + '.Zaehlerstand.kumuliert', 0, {name: 'Kumulierter Zählerstand (' + geraet + ') inkl. Backups', type: 'number', unit:'Wh'});
            
    // Zählerstand
    createState(pfad + geraet + '.Zaehlerstand.Tag',     0, {name: 'Zählerstand Tagesbeginn ('       + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Zaehlerstand.Woche',   0, {name: 'Zählerstand Wochenbeginn ('      + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Zaehlerstand.Monat',   0, {name: 'Zählerstand Monatsbeginn ('      + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Zaehlerstand.Quartal', 0, {name: 'Zählerstand Quartalsbeginn ('    + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Zaehlerstand.Jahr',    0, {name: 'Zählerstand Jahresbeginn ('      + geraet + ')', type: 'number', unit:'kWh'});
            
    // Backup Zählerstand
    createState(pfad + geraet + '.Zaehlerstand.Backup',  0, {
        name: 'Zählerstand Backup ('+ geraet + '), Differenz aus altem und neuem Wert nach Überlauf oder Reset',
        desc: 'wird beim Umspringen des Original-Zählerstandes (' + geraet + ') zu diesem addiert',
        type: 'number',
        unit: 'Wh'});
        
    // Verbrauch 
    createState(pfad + geraet + '.Verbrauch.Tag',        0, {name: 'Verbrauch seit Tagesbeginn ('    + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Verbrauch.Woche',      0, {name: 'Verbrauch seit Wochenbeginn ('   + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Verbrauch.Monat',      0, {name: 'Verbrauch seit Monatsbeginn ('   + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Verbrauch.Quartal',    0, {name: 'Verbrauch seit Quartalsbeginn (' + geraet + ')', type: 'number', unit:'kWh'});
    createState(pfad + geraet + '.Verbrauch.Jahr',       0, {name: 'Verbrauch seit Jahresbeginn ('   + geraet + ')', type: 'number', unit:'kWh'});
            
    // Stromkosten
    createState(pfad + geraet + '.Kosten.Tag',           0, {name: 'Stromkosten heute ('             + geraet + ')', type: 'number', unit:'€'  });
    createState(pfad + geraet + '.Kosten.Woche',         0, {name: 'Stromkosten Woche ('             + geraet + ')', type: 'number', unit:'€'  });
    createState(pfad + geraet + '.Kosten.Monat',         0, {name: 'Stromkosten Monat ('             + geraet + ')', type: 'number', unit:'€'  });
    createState(pfad + geraet + '.Kosten.Monat',         0, {name: 'Stromkosten Monat ('             + geraet + ')', type: 'number', unit:'€'  });
    createState(pfad + geraet + '.Kosten.Quartal',       0, {name: 'Stromkosten Quartal ('           + geraet + ')', type: 'number', unit:'€'  });
    createState(pfad + geraet + '.Kosten.Jahr',          0, {name: 'Stromkosten Jahr ('              + geraet + ')', type: 'number', unit:'€'  });
            
    if (logging) log('States in der Instanz ' + instanz + pfad + ' erstellt');   
}

function checkBlacklist (name) {                                                // Unterfunktion von entferneDatenpukt
    for(var i = 0; i &lt; blacklist.length; i++) {                                 // Blacklist durchgehen
        if (name.indexOf(blacklist[i]) != -1) {                                 // wenn vorhanden (nicht nicht vorhanden)
            return( name.substring(0, name.indexOf(blacklist[i])) );            // Zeichenketten aus der Blacklist löschen
        } 
    }  
}

function entferneDatenpunkt(geraet) {
    var rueckgabe;
    if (geraet.indexOf(":2.ENERGY_COUNTER") != -1) {
        rueckgabe = geraet.substring(0, geraet.indexOf(":2.ENERGY_COUNTER"));
    } else 
    if (geraet.indexOf(".METER") != -1) {
        rueckgabe = geraet.substring(0, geraet.indexOf(".METER"));
    }
    // Rückgabe sollte keine Sonderzeichen oder Leerzeichen enthalten. Wenn doch, werden die entfernt oder ersetzt
    // todo
    rueckgabe = checkBlacklist(rueckgabe);                                      // Wenn man keine Blacklist braucht, kann man diesen Teil auskommentieren
    return rueckgabe;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-2">2</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-4">4</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-6">6</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-8">8</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-10">10</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-12">12</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-14">14</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-16">16</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-18">18</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-20">20</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-22">22</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-24">24</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-26">26</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-28">28</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-30">30</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-32">32</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-34">34</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-36">36</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-38">38</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-40">40</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-42">42</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-44">44</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-46">46</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-48">48</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-50">50</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-52">52</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-54">54</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-56">56</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-58">58</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-60">60</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-62">62</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-64">64</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-66">66</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-68">68</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-70">70</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-72">72</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-74">74</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-76">76</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-78">78</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-80">80</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-82">82</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-84">84</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-86">86</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-88">88</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-90">90</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-92">92</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-94">94</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-96">96</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-98">98</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-100">100</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-102">102</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-104">104</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-106">106</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-108">108</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-110">110</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-112">112</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-114">114</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-116">116</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-118">118</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-120">120</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-122">122</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-124">124</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-126">126</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-128">128</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-130">130</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-132">132</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-134">134</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-136">136</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-138">138</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-140">140</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-142">142</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-144">144</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-146">146</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-148">148</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-150">150</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-152">152</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-154">154</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-156">156</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-158">158</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-160">160</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-162">162</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-164">164</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-166">166</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-168">168</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-170">170</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-172">172</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-174">174</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-176">176</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-178">178</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-180">180</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-182">182</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-184">184</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-186">186</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-188">188</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-190">190</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-192">192</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-194">194</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-196">196</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-198">198</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-200">200</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-202">202</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-204">204</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-206">206</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-208">208</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-210">210</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-212">212</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-214">214</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-216">216</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-218">218</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-220">220</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-222">222</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-224">224</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-226">226</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-228">228</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-230">230</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-232">232</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-234">234</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-236">236</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-238">238</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-240">240</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-242">242</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-244">244</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-246">246</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-248">248</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-250">250</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-252">252</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-254">254</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-256">256</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-258">258</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-260">260</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-262">262</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-264">264</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-266">266</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-268">268</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-270">270</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-272">272</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cefa6c47352c166909499-274">274</div><div class="crayon-num" data-line="crayon-5cefa6c47352c166909499-275">275</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cefa6c47352c166909499-1"><span class="crayon-c">/* Strom Zaehlerstaende, Verbrauch und Kosten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-2">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-3"><span class="crayon-c">Skript dient zur Ermittlung des Stromverbrauchs bei Geräten, </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-4"><span class="crayon-c">die mit den Homematic Zwischenstecker-Schaltaktor mit Leistungsmessung oder den FS20 EM1000 verbunden sind</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-6"><span class="crayon-c">Zählerstände werden gespeichert jeweils</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-7"><span class="crayon-c">-jeden Tag</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-8"><span class="crayon-c">-jede Woche Montag</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-9"><span class="crayon-c">-jeden Monatsersten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-10"><span class="crayon-c">-jeden Quartalsersten</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-11"><span class="crayon-c">-jedes Neujahr</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-12"><span class="crayon-c">wenn ein neuer Wert reinkommt.</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-14"><span class="crayon-c">Der Strompreis wird in die Variable "Strompreis_aktuell" geschrieben. </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-15"><span class="crayon-c">Änderungen des Strompreispreises müssen rechtzeitig per Cronjob programmiert werden.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-16">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-17"><span class="crayon-c">Die Stromkosten (Verbrauch * Preis) werden ebenso</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-18"><span class="crayon-c">-jeden Tag</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-19"><span class="crayon-c">-jede Woche Montag</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-20"><span class="crayon-c">-jeden Monatsersten</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-21"><span class="crayon-c">-jeden Quartalsersten</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-22"><span class="crayon-c">-jedes Neujahr</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-24"><span class="crayon-c">genullt und bis dahin durch die Berechnung (der Differenz des aktuellen Zählerstandes - Zählerstand Beginn des Zeitraums) * Strompreis ermittelt</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-26"><span class="crayon-c">Der kumulierte Zählerstand berücksichtigt evtl. Resets und Überläufe der realen Zählerstände der Geräte.</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-28"><span class="crayon-c">Todo: Wenn aktueller Zählerstand &lt; letzter Zählerstand, dann push und korrektur </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-29"><span class="crayon-c">wie hier: http://homematic-forum.de/forum/viewtopic.php?f=27&amp;t=23688&amp;p=201954&amp;hilit=HM+ES+PMSw1+Pl+Zähler#p201959</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-30">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-31"><span class="crayon-c">erstellt: 09.02.2016 von pix auf Basis des alten Skriptes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-32"><span class="crayon-c">01.03.2016 Leerzeichen werden aus Gerätenamen gelöscht</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-33"><span class="crayon-c">*/</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-34">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-35"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">logging</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-36"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">instanz</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'javascript.2'</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-37"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-e ">pfad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'Strom.'</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Pfad innerhalb der Instanz</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-38"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">blacklist</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">' Strommessung'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' Küche'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// persönliche Blacklist: Diese Teile werden aus den Homematic Gerätenamen entfernt</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-40"><span class="crayon-c">// Variablen erstellen, Zählerstände einlesen und Stromkosten errechnen (pro Gerät)</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-41"><span class="crayon-c">// Strompreis</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-42"><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'Preis.aktuell.Arbeitspreis'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2495</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Strompreis - aktueller Arbeitspreis (brutto)'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'€/kWh'</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-45"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-46"><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'Preis.aktuell.Grundpreis'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// wird noch nicht eingerechnet</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Strompreis - aktueller Grundpreis (brutto)'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'€/Monat'</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-49"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-50">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-51"><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">idStrompreis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'Preis.aktuell.Arbeitspreis'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-52">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-53"><span class="crayon-c">// Einlesen der aktuellen Daten vom Zähler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-54"><span class="crayon-e">on</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-v">METER</span><span class="crayon-o">|</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-v">ENERGY_COUNTER</span><span class="crayon-sy">$</span><span class="crayon-o">/</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-55"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">idbyname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getIdByName</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">common</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'-------- Strommesser ---------'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'RegExp-Funktion ausgelöst'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Gewerk:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">role</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// undefined</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Beschreibung: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">desc</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// undefined</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'id:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">common</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Waschmaschine Küche:2.ENERGY_COUNTER !!!!! Mac mini Strommessung.METER</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'channel ID:&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">channelId</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// hm-rpc.0.MEQ0170864.2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'channel Name: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">channelName</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Waschmaschine Küche:2</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'device ID:&nbsp;&nbsp;&nbsp;&nbsp;'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">deviceId</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// hm-rpc.0.MEQ0170864</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'device name:&nbsp;&nbsp;'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">deviceName</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Küche Waschmaschine</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'neuer Wert:&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// 16499.699982</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'alter Wert:&nbsp;&nbsp; '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// 16499.699982</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Einheit:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">common</span><span class="crayon-sy">.</span><span class="crayon-v">unit</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// Wh</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'IDbyNameFunktion: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">idbyname</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// hm-rpc.0.MEQ0170864.2.ENERGY_COUNTER</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Gerätenamen erstellen</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">entferneDatenpunkt</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">common</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-c ">/\s/g</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// per Regexp Leerzeichen entfernen</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Gerätename: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// States erstellen (CreateStates für dieses Gerät)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">erstelleStates</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// prüfe eingehende Daten</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// nicht nötig, da subscribe eh nur anspringt, wenn gelieferte Daten = oder &gt; sind als alte (gt)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// zweiter subscribe übernimmt das</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// prüfe und schreibe Daten&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">idKumuliert</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.kumuliert'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">idBackup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Backup'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// neuer Wert größer alter wert -&gt; alles gut</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">idKumuliert</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idBackup</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Kumulierten Wert mit Ist-Wert (inkl. Backup) synchronisieren</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// neuer Wert kleiner als alter Wert -&gt; Achtung Zähler im Gerät übergelaufen oder genullt</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">differenz</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Differenz berechnen</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">idBackup</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idBackup</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">differenz</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// und Differenz und Backup addieren "und den Werteabriss ausgleichen"</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">idKumuliert</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idBackup</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// damit neuer kumulierter Wert stetig weiter wächst</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">meldung</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Achtung!\n\n'</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'Der Stromzählerstand ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') ist übergelaufen oder gelöscht worden (ggf. Stromausfall).\n'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'Der letzte Zählerstand vor dem Reset wird nun zum Neuen addiert. Bitte unbedingt die Werte prüfen. \n\n '</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'ioBroker'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">betreff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ioBroker Meldung'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">prio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">OptinPushPrio</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">meldung_push</span><span class="crayon-sy">(</span><span class="crayon-v">meldung</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">betreff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prio</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Zählerstand ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraetename</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') übergelaufen oder genullt. Backup wird ab jetzt verwendet.'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'error'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// aktualisiere den Verbrauch und die Kosten</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">berechneVerbrauchKosten</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idKumuliert</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idStrompreis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// in kWh</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-108"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-109"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// ETAPPENWERTE SPEICHERN und RESETS DER WERTE #################################</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Verzögerungen eingebaut. Resets, wenn die ersten Werte der neuen Etappe reinkommen</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Stunde</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">Stunde</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// neue Stunde kleiner als alte Stunde (Mitternacht)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-112"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Tag'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-115"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Tag'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Wochentag</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Wochentag</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// So auf Mo</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-120"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Woche'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Woche'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-125"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-127"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Tag</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">newState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">Tag</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// wenn alter Tag größer als neuer Tag (am 1. eines Monats)&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-129"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Monat'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-130"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-131"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Monat'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-133"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">old_month</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">parseInt</span><span class="crayon-sy">(</span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Monat</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">new_month</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">parseInt</span><span class="crayon-sy">(</span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">state</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Monat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// wenn obj.oldState.ts im März [3] und obj.newState.ts im April [4] oder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-138"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.oldState.ts im Juni [6] und obj.newState.ts im Juli [7] oder</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-139"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.oldState.ts im Sept [9] und obj.newState.ts im Okt [10] oder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-140"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.oldState.ts im Dez [12] und obj.newState.ts im Jan [1], dann Quartal</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-141"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//log('Monat (alt): ' + old_month);</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-142"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//log('Monat (neu): ' + new_month);</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-143"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">old_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">new_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">old_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">new_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">old_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">new_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">old_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">new_month</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-144"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-145"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Quartal'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-146"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-147"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-148"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Quartal'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-149"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-150"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-151"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// wenn obj.oldState.ts im alten Jahr liegt, dann Jahr</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-152"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">obj</span><span class="crayon-sy">.</span><span class="crayon-v">oldState</span><span class="crayon-sy">.</span><span class="crayon-v">ts</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Jahr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Jahr</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-153"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-154"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Jahr'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-156"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">setTimeout</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-157"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraetename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Jahr'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-158"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-159"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-160"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'------------ ENDE ------------'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-161"><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-162">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-163"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">schreibeZaehlerstand</span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-164"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">idKumuliert</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.kumuliert'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-165"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">idZaehlerstand</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-166"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Zählerstand für übergebene Zeitraum und das Gerät in Wh auslesen </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">idZaehlerstand</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">parseFloat</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">idKumuliert</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// und in kWh (mit drei Dezimalstellen) speichern (also durch 1000)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-168"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-169"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// hier externe Protokollierung in Datei einbauen</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-170"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-171"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Zählerstände für das Gerät '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">' ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') gespeichert'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-172"><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-173">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-174"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">resetKostenVerbrauch</span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-175"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Reset der Stromkosten für den übergebenen Zeitraum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-176"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Reset des Stromverbrauchs für den übergebenen Zeitraum </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-177"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Stromkosten und Stromverbrauch für das Gerät '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">' ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">zeitraum</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') zurückgesetzt'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-178"><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-179">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-180"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">zeit</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">time</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-181"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">jetzt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-r">Date</span><span class="crayon-sy">(</span><span class="crayon-e">formatDate</span><span class="crayon-sy">(</span><span class="crayon-v">time</span><span class="crayon-sy">,</span><span class="crayon-s">"JJJJ.MM.TT SS:mm:ss"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-182"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">jahr</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getFullYear</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-183"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">monat</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMonth</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMonth</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMonth</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-184"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">tag</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getDate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getDate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getDate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-185"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">wochentag</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getDay</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// startet am Sonntag mit 0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-186"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">stunde</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getHours</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getHours</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getHours</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-187"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">minute</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMinutes</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMinutes</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getMinutes</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-188"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">sekunde</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getSeconds</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getSeconds</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jetzt</span><span class="crayon-sy">.</span><span class="crayon-e">getSeconds</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-189"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-190"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Jahr'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">jahr</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-191"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Monat'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">monat</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-192"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Tag'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tag</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-193"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Wochentag'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">wochentag</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-194"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Stunde'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">stunde</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Minute'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">minute</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Sekunde'</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">sekunde</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-198"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-199">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-200"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">berechneVerbrauchKosten</span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">zaehler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// bei jedem eingehenden Wert pro Gerät</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-201"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Tag [Verbrauchskosten = (Zähler_ist - Zähler_Tagesbeginn) * Preis ] --- zaehler muss immer größer sein als Tages, Wochen, etc.-Wert</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-202"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Tag'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Tag'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Verbrauch an diesem Tag in kWh</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-203"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Tag'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Tag'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Kosten an diesem Tag in €</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-204"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Woche&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-205"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Woche'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Woche'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-206"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Woche'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Woche'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-207"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Monat&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-208"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Monat'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-209"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Monat'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-210"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Quartal&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-211"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Quartal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Quartal'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-212"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Quartal'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Quartal'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-213"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Jahr&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-214"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Jahr'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Jahr'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-215"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">setState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Jahr'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">zaehler</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getState</span><span class="crayon-sy">(</span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Jahr'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">preis</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">toFixed</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-216"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'Stromverbrauch und -kosten ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') aktualisiert'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'info'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-217"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-218">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-219"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">erstelleStates</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-220"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Kumulierter Zählerstand (wird nie kleiner)</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-221"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.kumuliert'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Kumulierter Zählerstand ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') inkl. Backups'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'Wh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-222"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-223"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Zählerstand</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-224"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Tag'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Tagesbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-225"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Woche'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Wochenbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-226"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Monatsbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-227"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Quartal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Quartalsbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-228"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Jahr'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Jahresbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-229"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-230"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Backup Zählerstand</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-231"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Zaehlerstand.Backup'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-232"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Zählerstand Backup ('</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'), Differenz aus altem und neuem Wert nach Überlauf oder Reset'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-233"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">desc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'wird beim Umspringen des Original-Zählerstandes ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">') zu diesem addiert'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-234"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-235"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Wh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-236"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-237"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Verbrauch </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-238"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Tag'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Verbrauch seit Tagesbeginn ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-239"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Woche'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Verbrauch seit Wochenbeginn ('</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-240"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Verbrauch seit Monatsbeginn ('</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-241"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Quartal'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Verbrauch seit Quartalsbeginn ('</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-242"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Verbrauch.Jahr'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Verbrauch seit Jahresbeginn ('</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'kWh'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-243"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-244"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Stromkosten</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-245"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Tag'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten heute ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-246"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Woche'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten Woche ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-247"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten Monat ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-248"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Monat'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten Monat ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-249"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Quartal'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten Quartal ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-250"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createState</span><span class="crayon-sy">(</span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'.Kosten.Jahr'</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Stromkosten Jahr ('</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">')'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'number'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">unit</span><span class="crayon-o">:</span><span class="crayon-s">'€'</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-251"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-252"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logging</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-s">'States in der Instanz '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">instanz</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">pfad</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">' erstellt'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-253"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-254">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-255"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">checkBlacklist</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Unterfunktion von entferneDatenpukt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-256"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">blacklist</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Blacklist durchgehen</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-257"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-v">blacklist</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// wenn vorhanden (nicht nicht vorhanden)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-258"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-e">substring</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-v">blacklist</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Zeichenketten aus der Blacklist löschen</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-259"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-260"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-261"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-262">&nbsp;</div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-263"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">entferneDatenpunkt</span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-264"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">rueckgabe</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-265"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">":2.ENERGY_COUNTER"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-266"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rueckgabe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">substring</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">":2.ENERGY_COUNTER"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-267"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-268"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">".METER"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-269"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rueckgabe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">substring</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">geraet</span><span class="crayon-sy">.</span><span class="crayon-e">indexOf</span><span class="crayon-sy">(</span><span class="crayon-s">".METER"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-270"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-271"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Rückgabe sollte keine Sonderzeichen oder Leerzeichen enthalten. Wenn doch, werden die entfernt oder ersetzt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-272"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// todo</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-273"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rueckgabe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">checkBlacklist</span><span class="crayon-sy">(</span><span class="crayon-v">rueckgabe</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Wenn man keine Blacklist braucht, kann man diesen Teil auskommentieren</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cefa6c47352c166909499-274"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">rueckgabe</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5cefa6c47352c166909499-275"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0836 seconds] -->
<p>&nbsp;</p>
				
<footer class="post-data">
	
	<div class="entry-meta">
			</div><!-- .entry-meta -->
	</footer><!-- .post-data -->
			</div><!-- .post-entry -->
	</article><!-- #post-## -->

					
				
			</main><!-- #main -->
			
<div id="widgets" class="widget-area default-sidebar" role="complementary" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
		
		<aside id="archives" class="widget-wrapper">
			<h3 class="widget-title">Im Archiv</h3>
			<ul>
					<li><a href='index-172.htm?m=201902&#038;lang=de'>Februar 2019</a></li>
	<li><a href='index-173.htm?m=201901&#038;lang=de'>Januar 2019</a></li>
	<li><a href='index-174.htm?m=201812&#038;lang=de'>Dezember 2018</a></li>
	<li><a href='index-175.htm?m=201806&#038;lang=de'>Juni 2018</a></li>
	<li><a href='index-176.htm?m=201804&#038;lang=de'>April 2018</a></li>
	<li><a href='index-177.htm?m=201803&#038;lang=de'>März 2018</a></li>
	<li><a href='index-178.htm?m=201801&#038;lang=de'>Januar 2018</a></li>
	<li><a href='index-179.htm?m=201712&#038;lang=de'>Dezember 2017</a></li>
	<li><a href='index-180.htm?m=201711&#038;lang=de'>November 2017</a></li>
	<li><a href='index-181.htm?m=201710&#038;lang=de'>Oktober 2017</a></li>
	<li><a href='index-182.htm?m=201709&#038;lang=de'>September 2017</a></li>
	<li><a href='index-183.htm?m=201708&#038;lang=de'>August 2017</a></li>
	<li><a href='index-184.htm?m=201701&#038;lang=de'>Januar 2017</a></li>
	<li><a href='index-185.htm?m=201609&#038;lang=de'>September 2016</a></li>
	<li><a href='index-186.htm?m=201607&#038;lang=de'>Juli 2016</a></li>
	<li><a href='index-187.htm?m=201605&#038;lang=de'>Mai 2016</a></li>
	<li><a href='index-188.htm?m=201604&#038;lang=de'>April 2016</a></li>
	<li><a href='index-189.htm?m=201603&#038;lang=de'>März 2016</a></li>
	<li><a href='index-190.htm?m=201602&#038;lang=de'>Februar 2016</a></li>
			</ul>
		</aside>

		</div><!-- #default-sidebar -->
	</div><!-- #primary -->

</div><!-- end of #wrapper -->
</div><!-- end of #container -->


<footer id="footer" class="site-footer" role="contentinfo" itemscope="itemscope" itemtype="http://schema.org/WPFooter">
		<div id="footer-wrapper">

		<div id="footer-widgets-container">
					</div><!-- #footer-widgets-container-->

		<div id="menu-social-container">
			<nav id="footer-menu-container">
				<ul id="menu-2016_seitenfuss_de" class="footer-menu"><li id="menu-item-2210" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2210"><a href="index-61.htm?page_id=2208&#038;lang=de">Kontakt</a></li>
<li id="menu-item-2227" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2227"><a href="index-62.htm?page_id=2223&#038;lang=de">Impressum</a></li>
<li id="menu-item-2307" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2307"><a href="index-63.htm?page_id=2305&#038;lang=de">Datenschutzerklärung</a></li>
<li id="menu-item-2314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2314"><a href="index-64.htm?page_id=2303&#038;lang=de">Sitemap</a></li>
<li id="menu-item-2486" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2486"><a href="index-65.htm?page_id=2484&#038;lang=de">Danke</a></li>
</ul>			</nav><!-- #footer-menu -->
			<div id="social-icons-container">
				<ul class="social-icons"></ul><!-- .social-icons -->			</div><!-- #social-icons-container-->
		</div><!-- #menu-social-container -->

		
		<div id="footer-base">
			<div class="copyright">
				&copy; 2019 <a href="index.htm?lang=de" title="ioBroker">ioBroker</a>			</div><!-- .copyright -->

			<div class="powered">
				<a href="http://cyberchimps.com/responsive-II/">Reaktionsschnelle II</a> angetrieben <a href="http://wordpress.org/">WordPress</a>			</div><!-- end .powered -->

			<div class="scroll-top">
				<a href="#scroll-top" title="Nach oben scrollen">↑</a>
			</div><!-- .scroll-top -->
		</div><!-- #footer-base -->
	</div><!-- #footer-wrapper -->
	</footer><!-- #footer -->
<div id="cookie-law-info-bar"><span>This website uses cookies to improve your experience. We'll assume you're ok with this, but you can opt-out if you wish.<a data-cli_action="accept" id="cookie_action_close_header" class="medium cli-plugin-button cli-plugin-main-button cookie_action_close_header cli_action_button" style="display:inline-block; ">Akzeptieren</a> <a href='..\index-1.htm?page_id=2305&#038;lang=de' id="CONSTANT_OPEN_URL" target="_blank" class="cli-plugin-main-link" style="display:inline-block;">mehr Infos</a></span></div><div id="cookie-law-info-again" style="display:none;"><span id="cookie_hdr_showagain">Privacy & Cookies Policy</span></div><div class="cli-modal-backdrop cli-fade cli-settings-overlay"></div>
<div class="cli-modal-backdrop cli-fade cli-popupbar-overlay"></div>
<script type="text/javascript">
  /* <![CDATA[ */
  cli_cookiebar_settings='{"animate_speed_hide":"500","animate_speed_show":"500","background":"#fff","border":"#444","border_on":false,"button_1_button_colour":"#000","button_1_button_hover":"#000000","button_1_link_colour":"#fff","button_1_as_button":true,"button_1_new_win":false,"button_2_button_colour":"#333","button_2_button_hover":"#292929","button_2_link_colour":"#444","button_2_as_button":false,"button_2_hidebar":true,"button_3_button_colour":"#000","button_3_button_hover":"#000000","button_3_link_colour":"#fff","button_3_as_button":true,"button_3_new_win":false,"button_4_button_colour":"#000","button_4_button_hover":"#000000","button_4_link_colour":"#fff","button_4_as_button":true,"font_family":"inherit","header_fix":false,"notify_animate_hide":true,"notify_animate_show":false,"notify_div_id":"#cookie-law-info-bar","notify_position_horizontal":"right","notify_position_vertical":"bottom","scroll_close":false,"scroll_close_reload":false,"accept_close_reload":false,"reject_close_reload":false,"showagain_tab":false,"showagain_background":"#fff","showagain_border":"#000","showagain_div_id":"#cookie-law-info-again","showagain_x_position":"100px","text":"#000","show_once_yn":false,"show_once":"10000","logging_on":false,"as_popup":false,"popup_overlay":true,"bar_heading_text":"","cookie_bar_as":"banner","popup_showagain_position":"bottom-right","widget_position":"left"}';
  /* ]]> */
</script><div class="scroll-back-to-top-wrapper">
	<span class="scroll-back-to-top-inner">
					<i class="fa fa-2x fa-arrow-circle-up"></i>
			</span>
</div><script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"http:\/\/www.iobroker.net\/docu\/?rest_route=\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Bitte best\u00e4tige, dass du keine Maschine bist."}}};
var wpcf7 = {"apiSettings":{"root":"http:\/\/www.iobroker.net\/docu\/?rest_route=\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Bitte best\u00e4tige, dass du keine Maschine bist."}}};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content\plugins\contact-form-7\includes\js\scripts.js?ver=4.9.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var scrollBackToTop = {"scrollDuration":"500","fadeDuration":"0.5"};
var scrollBackToTop = {"scrollDuration":"500","fadeDuration":"0.5"};
/* ]]> */
</script>
<script type='text/javascript' src='wp-content\plugins\scroll-back-to-top\assets\js\scroll-back-to-top.js'></script>
<script type='text/javascript' src='wp-content\plugins\table-of-contents-plus\front.min.js?ver=1509'></script>
<script type='text/javascript' src='wp-content\themes\responsive-mobile\js\responsive-scripts.min.js?ver=1.2.5'></script>
<script type='text/javascript' src='wp-includes\js\wp-embed.min.js?ver=4.7.5'></script>
</body>
</html>
